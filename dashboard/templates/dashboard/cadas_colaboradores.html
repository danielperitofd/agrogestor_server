
{% extends 'dashboard/base.html' %}
{% block title %}Cadastro de Colaboradores{% endblock %}
{% block content %}
{% load widget_tweaks %}
<div class="container py-4">

  <!-- Alerta de erros -->
  {% if form.errors %}
  <div class="alert alert-danger alert-dismissible fade show shadow-sm" role="alert">
    <strong>Erro ao salvar:</strong><br>
    {% for field in form %}
      {% for error in field.errors %}
        {{ error }}<br>
      {% endfor %}
    {% endfor %}
    {% for error in form.non_field_errors %}
      {{ error }}<br>
    {% endfor %}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Fechar"></button>
  </div>
  {% endif %}

  <!-- Cabe√ßalho -->
  <div class="text-center mb-4">
    <h2 class="fw-semibold">
      üë∑‚Äç‚ôÇÔ∏è {{ editando|yesno:"Editar Colaborador,Novo Colaborador" }}
    </h2>
    <hr class="w-50 mx-auto text-secondary opacity-25">
  </div>

  <!-- Conte√∫do principal: formul√°rio + painel -->
  <div class="row g-4">

    <!-- Formul√°rio -->
    <div class="col-lg-7">
      <div class="card shadow-sm border-0 rounded-4">
        <div class="card-body p-4">
          <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
            {% csrf_token %}

            <div class="row g-3">
              <div class="col-md-6">
                <label for="id_nome" class="form-label">Nome</label>
                {{ form.nome|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_tipo" class="form-label">Tipo</label>
                {{ form.tipo|add_class:"form-select" }}
              </div>

              <div class="col-md-6">
                <label for="id_cpf" class="form-label">CPF</label>
                {{ form.cpf|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_rg" class="form-label">RG</label>
                {{ form.rg|add_class:"form-control" }}
              </div>

              <div class="col-md-6">
                <label for="id_nome_mae" class="form-label">Nome da M√£e</label>
                {{ form.nome_mae|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_telefone" class="form-label">Telefone</label>
                {{ form.telefone|add_class:"form-control" }}
              </div>

              <div class="col-md-6">
                <label for="id_email" class="form-label">E-mail</label>
                {{ form.email|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_foto" class="form-label">Foto</label>
                {{ form.foto|add_class:"form-control" }}
              </div>
            </div>

            <!-- Bot√µes -->
            <div class="d-flex justify-content-between flex-wrap gap-2 mt-4">
              <button type="submit" class="btn btn-success px-4">
                <i class="fa-solid fa-save me-2"></i>Salvar
              </button>
              <button type="reset" class="btn btn-outline-danger px-4">
                <i class="fa-solid fa-xmark me-2"></i>Cancelar
              </button>
              <a href="{% url 'listar_colaboradores' %}" class="btn btn-outline-secondary px-4">
                <i class="fas fa-users me-2"></i>Colaboradores
              </a>
            </div>

            <!-- Mensagens de sucesso -->
            {% if messages %}
            {% for message in messages %}
              <div class="alert alert-success mt-4 text-center shadow-sm">
                <strong>{{ message }}</strong>
              </div>
            {% endfor %}
            {% endif %}
          </form>
        </div>
      </div>
    </div>

    <!-- Painel informativo -->
    <div class="col-lg-5">
      <div class="card border-0 shadow-sm rounded-4 bg-light h-100">
        <div class="card-body p-4">
          <h4 class="mb-3">üìå Informa√ß√µes</h4>

          <p><strong>Dados Obrigat√≥rios:</strong></p>
          <ul class="small mb-3">
            <li>Nome</li>
            <li>Tipo</li>
            <li>CPF</li>
            <li>RG</li>
            <li>Nome da M√£e</li>
            <li>Telefone</li>
          </ul>

          <p><strong>Dados Opcionais:</strong></p>
          <ul class="small mb-3">
            <li>E-mail</li>
            <li>Foto</li>
          </ul>

          <p><strong>Dicas:</strong></p>
          <ul class="small">
            <li>CPF deve ser √∫nico no sistema</li>
            <li>Colaboradores podem ter m√∫ltiplos pap√©is (ex: vaqueiro e encarregado)</li>
            <li>Use o formato: <code>000.000.000-00</code></li>
          </ul>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  // Esconde alertas ao clicar fora
  document.addEventListener('click', function (e) {
    document.querySelectorAll('.alert').forEach(alert => {
      if (!alert.contains(e.target)) alert.classList.add('d-none');
    });
  });
</script>

{% endblock %}
